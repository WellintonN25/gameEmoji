        @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@700;900&family=Manrope:wght@400;600;800&family=Titan+One&display=swap');

        :root {
            --c-bg: #f3f4f6;
            --c-panel: rgba(255, 255, 255, 0.98);
            --c-primary: #3b82f6;
            --c-accent: #8b5cf6;
            --c-gold: #f59e0b;
            --c-danger: #ef4444;
            --c-success: #10b981;
            --c-text: #1f2937;
            --c-text-dim: #6b7280;
            --c-border: #e5e7eb;
            --dock-height: 80px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
        }

        body {
            background: #eef2f6;
            font-family: 'Manrope', sans-serif;
            color: var(--c-text);
            height: 100dvh;
            width: 100vw;
            display: flex;
            justify-content: center;
            overflow: hidden;
        }

        #app {
            width: 100%;
            max-width: 500px;
            height: 100%;
            position: relative;
            background: #f9fafb;
            box-shadow: 0 0 50px rgba(0, 0, 0, 0.2);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        #app::before {
            content: '';
            position: absolute;
            inset: 0;
            background: radial-gradient(circle at 50% 50%, rgba(59, 130, 246, 0.08), transparent 70%);
            z-index: 0;
            pointer-events: none;
        }

        h1,
        h2,
        h3 {
            font-family: 'Cinzel', serif;
            text-transform: uppercase;
            color: #111827;
            margin: 0;
        }

        .text-gold {
            color: var(--c-gold);
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }

        /* UI BASE */
        .screen {
            position: absolute;
            inset: 0;
            display: none;
            flex-direction: column;
            z-index: 10;
            padding-bottom: calc(var(--dock-height) + env(safe-area-inset-bottom));
            opacity: 0;
            transition: opacity 0.3s;
            background: var(--c-bg);
            overflow: hidden;
        }

        .screen.active {
            display: flex;
            opacity: 1;
            z-index: 20;
        }

        .scroll-y {
            overflow-y: auto;
            flex: 1;
            -webkit-overflow-scrolling: touch;
            padding-bottom: 19px;
            min-height: 0;
        }

        .panel {
            background: var(--c-panel);
            backdrop-filter: blur(12px);
            border: 1px solid var(--c-border);
            border-radius: 20px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
        }

        .panel.locked {
            opacity: 0.6;
            filter: grayscale(1);
            pointer-events: none;
            position: relative;
            overflow: hidden;
        }

        .panel.locked::after {
            content: '';
            position: absolute;
            inset: 0;
            background: rgba(255, 255, 255, 0.4);
        }

        /* BUTTONS */
        .btn {
            border: none;
            padding: 14px 20px;
            border-radius: 14px;
            font-weight: 800;
            text-transform: uppercase;
            font-size: 0.85rem;
            letter-spacing: 0.5px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.1s;
            position: relative;
            color: white;
            box-shadow: 0 4px 0 rgba(0, 0, 0, 0.15), 0 5px 10px rgba(0, 0, 0, 0.1);
            transform: translateY(0);
        }

        .btn:active {
            transform: translateY(4px);
            box-shadow: 0 0 0 rgba(0, 0, 0, 0.15), inset 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .btn:disabled {
            filter: grayscale(1);
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
            background: #ccc;
        }

        .btn-p {
            background: linear-gradient(to bottom, #3b82f6, #2563eb);
        }

        .btn-g {
            background: linear-gradient(to bottom, #f59e0b, #d97706);
        }

        .btn-a {
            background: linear-gradient(to bottom, #8b5cf6, #7c3aed);
        }

        .btn-d {
            background: linear-gradient(to bottom, #ef4444, #dc2626);
        }

        .btn-w {
            background: #fff;
            color: #444;
            border: 1px solid #ddd;
            box-shadow: 0 2px 0 #ddd;
        }

        .btn-w:active {
            transform: translateY(2px);
            box-shadow: none;
        }

        .btn-icon {
            width: 40px;
            height: 40px;
            padding: 0;
            border-radius: 50%;
            font-size: 1.2rem;
            background: #fff;
            color: #333;
            border: 1px solid #ddd;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }

        /* HEADER */
        .top-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            padding-top: max(15px, env(safe-area-inset-top));
            z-index: 50;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--c-border);
            height: 70px;
            flex-shrink: 0;
        }

        .cur-tag {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            background: #fff;
            border: 1px solid #e5e7eb;
            padding: 4px 2px;
            border-radius: 30px;
            font-size: 0.7rem;
            font-weight: 800;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            transition: transform 0.2s, color 0.2s;
        }

        .pulse-g {
            animation: pG 0.5s;
            color: #10b981 !important;
        }

        .pulse-r {
            animation: pR 0.5s;
            color: #ef4444 !important;
        }

        @keyframes pG {

            0%,
            100% {
                transform: scale(1)
            }

            50% {
                transform: scale(1.2)
            }
        }

        @keyframes pR {

            0%,
            100% {
                transform: scale(1)
            }

            50% {
                transform: scale(1.2)
            }
        }

        /* NAV DOCK */
        .nav-dock {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            margin-bottom: 1px;
            height: calc(var(--dock-height) + env(safe-area-inset-bottom));
            background: #fff;
            border-top: 1px solid var(--c-border);
            display: flex;
            justify-content: space-around;
            align-items: flex-start;
            padding-top: 12px;
            z-index: 100;
            box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.03);
        }

        .nav-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            color: #9ca3af;
            font-size: 0.65rem;
            font-weight: 700;
            width: 20%;
            cursor: pointer;
            transition: 0.2s;
        }

        .nav-btn.active {
            color: var(--c-primary);
        }

        .nav-btn .icon {
            font-size: 1.2rem;
            transition: 0.2s;
            filter: grayscale(1);
            opacity: 0.7;
        }

        .nav-btn.active .icon {
            transform: translateY(-6px) scale(1.1);
            filter: grayscale(0);
            opacity: 1;
        }

        .nav-btn.summon .icon {
            font-size: 1.5rem;
            color: var(--c-gold);
            filter: drop-shadow(0 4px 4px rgba(245, 158, 11, 0.3));
            opacity: 1;
            margin-top: -8px;
        }

        /* SLOTS & GRID */
        #inv-grid,
        #prep-grid,
        #rune-bag-grid,
        #evo-grid,
        #skill-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(59px, 2fr));
            gap: 10px;
            padding: 15px;
            align-content: flex-start;
            justify-content: center;
        }

        .hero-slot {
            width: 100%;
            aspect-ratio: 1;
            position: relative;
            background: #fff;
            border-radius: 14px;
            border: 2px solid #e5e7eb;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            transition: transform 0.1s;
            padding: 2px;
        }

        .hero-slot .stars {
            position: static;
            width: auto;
            margin: 0;
        }

        .hero-vis {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            font-size: 2rem;
            overflow: hidden;
        }

        .hero-slot:active {
            transform: scale(0.95);
        }

        .hero-slot.selected {
            border-color: var(--c-primary);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3);
        }

        .hero-slot .lvl-badge {
            position: absolute;
            bottom: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.8);
            color: #fff;
            font-size: 0.65rem;
            padding: 2px 5px;
            border-top-left-radius: 8px;
            font-weight: bold;
            z-index: 2;
        }

        .hero-slot.leg-glow {
            border-color: var(--c-gold);
            box-shadow: 0 0 10px rgba(245, 158, 11, 0.4);
        }

        /* IMAGE SUPPORT FIX - ADDED CLASSES */
        .hero-slot img,
        .custom-img,
        .visual img,
        .dex-slot img,
        .dx-sl img,
        .b-u img,
        .big-mdl img,
        .dex-vis img,
        .gacha-vis img,
        .arena-team-icon img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            display: block;
        }

        .stars {
            display: flex;
            gap: 1px;
            justify-content: center;
            position: absolute;
            top: 3px;
            width: 100%;
            z-index: 2;
        }

        .star {
            width: 8px;
            height: 8px;
            background: var(--c-gold);
            clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
        }

        /* SHOP & ITEMS */
        .shop-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(110px, 1fr));
            gap: 12px;
            padding: 10px;
        }

        .shop-card {
            background: #fff;
            border-radius: 16px;
            padding: 15px;
            border: 1px solid #eee;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.03);
            text-align: center;
            transition: 0.2s;
            position: relative;
        }

        .shop-card:active {
            transform: scale(0.98);
            border-color: var(--c-primary);
        }

        .shop-icon {
            font-size: 2.5rem;
            filter: drop-shadow(0 4px 2px rgba(0, 0, 0, 0.1));
        }

        .shop-name {
            font-weight: 800;
            font-size: 0.85rem;
            color: var(--c-text);
            line-height: 1.2;
        }

        .shop-price {
            margin-top: auto;
            width: 100%;
            font-size: 0.8rem;
            padding: 6px;
            border-radius: 8px;
        }

        /* BATTLE */
        #battle {
            background: linear-gradient(to bottom, #0f172a 0%, #000 100%) !important;
            padding-bottom: 0 !important;
            z-index: 50 !important;
            height: 100% !important;
            display: none;
            position: absolute;
            inset: 0;
            flex-direction: column;
        }

        #battle.active {
            display: flex !important;
        }

        .arena-floor {
            position: absolute;
            bottom: -20%;
            left: -50%;
            right: -50%;
            height: 100%;
            background: radial-gradient(ellipse at center, rgba(59, 130, 246, 0.05) 0%, transparent 60%),
                linear-gradient(0deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);
            background-size: 100% 100%, 50px 50px, 50px 50px;
            transform: perspective(600px) rotateX(70deg);
            box-shadow: 0 -100px 150px #000 inset;
            z-index: 0;
            pointer-events: none;
        }

        .bt-sc {
            flex: 1;
            position: relative;
            z-index: 5;
            display: flex;
            flex-direction: column;
            justify-content: center;
            perspective: 1000px;
            gap: 60px;
            padding-bottom: 160px;
        }

        .tm-rw {
            display: flex;
            justify-content: center;
            gap: 20px;
            min-height: 120px;
            position: relative;
            z-index: 5;
            align-items: flex-end;
        }

        .b-u {
            width: 90px;
            height: 90px;
            position: relative;
            display: flex;
            align-items: flex-end;
            justify-content: center;
            cursor: pointer;
            transition: transform .3s;
            z-index: 5;
        }

        .b-u .vis {
            font-size: 4rem;
            filter: drop-shadow(0 15px 10px rgba(0, 0, 0, 0.5));
            animation: idle 3s infinite ease-in-out;
            transform-origin: bottom center;
            transition: 0.3s;
        }

        .b-u.dead {
            pointer-events: none;
        }

        .b-u.dead .vis {
            animation: dissolve 0.5s forwards ease-out;
        }

        .b-u.dead .hp-bw,
        .b-u.dead .bfs {
            opacity: 0;
            transition: 0.2s;
        }

        @keyframes idle {

            0%,
            100% {
                transform: scaleY(1)
            }

            50% {
                transform: scaleY(0.96) translateY(2px)
            }
        }

        @keyframes dissolve {
            0% {
                filter: grayscale(0);
                opacity: 1;
                transform: scale(1);
            }

            100% {
                filter: grayscale(1) blur(10px);
                opacity: 0;
                transform: scale(1.5) translateY(-20px);
            }
        }

        .bfs {
            position: absolute;
            top: -35px;
            display: flex;
            gap: 2px;
            justify-content: center;
            width: 100%;
            z-index: 150;
        }

        .bf-ic {
            width: 20px;
            height: 20px;
            background: #222;
            border-radius: 4px;
            color: #fff;
            font-size: 0.7rem;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid #fff;
            font-weight: 700;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
        }

        .bf-ic.atk_buff {
            background: #ef4444;
        }

        .bf-ic.def_buff {
            background: #3b82f6;
        }

        .bf-ic.stun {
            background: #facc15;
            color: #000;
            animation: shake .5s infinite;
        }

        .bf-ic.poison {
            background: #10b981;
        }

        .buff-turn {
            position: absolute;
            bottom: -5px;
            right: -5px;
            font-size: 0.55rem;
            background: #000;
            color: #fff;
            padding: 0 3px;
            border-radius: 4px;
            font-weight: bold;
        }

        .b-u.act-t .vis {
            animation: activeZoom 1s infinite ease-in-out;
            filter: brightness(1.3) drop-shadow(0 0 20px rgba(255, 255, 255, 0.5));
            z-index: 20;
        }

        .b-u.actor .vis {
            animation: lunge .3s ease-in-out;
        }

        @keyframes lunge {
            0% {
                transform: translateY(0)
            }

            50% {
                transform: translateY(-60px) scale(1.2)
            }

            100% {
                transform: translateY(0)
            }
        }

        .b-u.hit .vis {
            animation: hit .4s;
            filter: brightness(3) sepia(1) hue-rotate(-50deg);
        }

        @keyframes hit {

            0%,
            100% {
                transform: translateX(0)
            }

            25% {
                transform: translateX(-10px)
            }

            75% {
                transform: translateX(10px)
            }
        }

        .hp-bw {
            position: absolute;
            bottom: -15px;
            width: 80%;
            height: 8px;
            background: rgba(0, 0, 0, 0.8);
            border-radius: 4px;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 2px 5px #000;
            left: 10%;
        }

        .hp-fill {
            height: 100%;
            background: #22c55e;
            width: 100%;
            transition: width .3s;
        }

        .ene .hp-fill {
            background: #ef4444;
        }

        .tgt-mk {
            position: absolute;
            top: -50px;
            color: #ef4444;
            font-size: 2.5rem;
            font-weight: 700;
            animation: bounce .6s infinite;
            text-shadow: 0 0 10px red;
            left: 50%;
            transform: translateX(-50%);
            z-index: 100;
        }

        @keyframes bounce {

            0%,
            100% {
                transform: translate(-50%, 0)
            }

            50% {
                transform: translate(-50%, -10px)
            }
        }

        .bt-hud {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 160px;
            background: linear-gradient(to top, rgba(15, 23, 42, 0.95), rgba(30, 41, 59, 0.8));
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(5px);
            border-radius: 25px 25px 0 0;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            transform: translateY(110%);
            transition: transform .3s cubic-bezier(0.18, 0.89, 0.32, 1.28);
            z-index: 20;
            padding-bottom: 20px;
            box-shadow: 0 -10px 50px #000;
        }

        .bt-hud.active {
            transform: translateY(0);
        }

        .sk-btn {
            width: 75px;
            height: 75px;
            border-radius: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: linear-gradient(145deg, #334155, #1e293b);
            box-shadow: 0 5px 0 #0f172a, 0 10px 10px rgba(0, 0, 0, 0.3);
            color: #fff;
            cursor: pointer;
            position: relative;
            border: 1px solid #475569;
            transition: transform 0.1s;
        }

        .sk-btn:active {
            transform: translateY(4px);
            box-shadow: 0 1px 0 #0f172a;
        }

        .sk-btn.cd {
            filter: grayscale(1);
            opacity: .5;
            pointer-events: none;
        }

        .dmg-pop {
            position: absolute;
            top: -80px;
            left: 50%;
            transform: translateX(-50%);
            font-family: 'Titan One', cursive;
            font-size: 3rem;
            color: #fbbf24;
            text-shadow: 3px 3px 0 #000;
            z-index: 200;
            pointer-events: none;
            animation: pop .6s cubic-bezier(0.18, 0.89, 0.32, 1.28) forwards;
            -webkit-text-stroke: 1px #000;
        }

        @keyframes pop {
            0% {
                opacity: 0;
                transform: translate(-50%, 20px) scale(0.5)
            }

            50% {
                opacity: 1;
                transform: translate(-50%, -60px) scale(1.2)
            }

            100% {
                opacity: 0;
                transform: translate(-50%, -100px) scale(1)
            }
        }

        /* GACHA */
        .gacha-bg {
            background: rgba(30, 27, 75, 0.98) !important;
            border: 2px solid #6366f1 !important;
            color: #fff;
            box-shadow: 0 0 50px rgba(99, 102, 241, 0.4) !important;
        }

        .portal-spin {
            font-size: 5rem;
            animation: spin 4s infinite linear;
            filter: drop-shadow(0 0 30px #8b5cf6);
            margin: 20px 0;
        }

        @keyframes spin {
            100% {
                transform: rotate(360deg);
            }
        }

        .gacha-unit {
            width: 80px;
            display: flex;
            flex-direction: column;
            align-items: center;
            background: #fff;
            border-radius: 12px;
            padding: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border: 2px solid #e5e7eb;
            animation: popIn 0.3s cubic-bezier(0.18, 0.89, 0.32, 1.28) backwards;
            color: #333;
        }

        .gacha-unit.nat5 {
            border-color: var(--c-gold);
            box-shadow: 0 0 15px var(--c-gold);
            animation: popIn 0.5s, glowPulse 1.5s infinite;
        }

        @keyframes popIn {
            0% {
                transform: scale(0)
            }

            100% {
                transform: scale(1)
            }
        }

        @keyframes glowPulse {
            0% {
                box-shadow: 0 0 5px var(--c-gold)
            }

            50% {
                box-shadow: 0 0 20px var(--c-gold), 0 0 40px var(--c-gold)
            }

            100% {
                box-shadow: 0 0 5px var(--c-gold)
            }
        }

        .gacha-vis {
            font-size: 2.5rem;
            margin-bottom: 5px;
        }

        .gacha-name {
            font-size: 0.7rem;
            font-weight: bold;
            color: #333;
            text-align: center;
            line-height: 1.2;
            margin-bottom: 2px;
        }

        .gacha-stars {
            display: flex;
            gap: 1px;
            justify-content: center;
            font-size: 0.6rem;
        }

        /* GENERAL UTILS */
        .toggle-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(145deg, #333, #111);
            color: #fff;
            border: 2px solid #555;
            font-weight: 800;
            font-size: 0.8rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.5);
            transition: 0.2s;
        }

        .toggle-btn.active {
            background: var(--c-success);
            border-color: #fff;
            box-shadow: 0 0 15px var(--c-success);
            transform: scale(1.1);
        }

        .modal {
            position: fixed;
            inset: 0;
            z-index: 300;
            background: rgba(0, 0, 0, 0.85);
            display: none;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(8px);
        }

        .modal.open {
            display: flex;
            animation: fadeIn .2s;
        }

        .modal-content {
            width: 90%;
            max-width: 360px;
            background: #fff;
            border-radius: 24px;
            padding: 25px;
            text-align: center;
            max-height: 85vh;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 15px;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
        }

        .stg-row {
            background: #fff;
            border-radius: 12px;
            padding: 15px 20px;
            margin-bottom: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.02);
            border: 1px solid #eee;
            border-left: 5px solid #ccc;
            transition: transform .2s;
            cursor: pointer;
        }

        .stg-row:not(.locked):active {
            transform: scale(.98);
        }

        .stg-row.locked {
            opacity: .6;
            filter: grayscale(1);
            cursor: not-allowed;
            background: #f9f9f9;
        }

        .stg-row.u {
            border-left-color: var(--c-primary);
        }

        .stg-row.c {
            border-left-color: var(--c-success);
            background: linear-gradient(to right, rgba(240, 253, 244, 0.8), rgba(255, 255, 255, 0.8));
        }

        .stg-row.b {
            border-left-color: var(--c-danger);
            border: 1px solid #fca5a5;
            background: linear-gradient(to right, rgba(254, 242, 242, 0.8), rgba(255, 255, 255, 0.8));
        }

        .stg-row.tb {
            border-left-color: var(--c-gold);
            border: 1px solid #fcd34d;
            background: linear-gradient(to right, rgba(255, 251, 235, 0.8), rgba(255, 255, 255, 0.8));
        }

        .stg-inf {
            display: flex;
            flex-direction: column;
            gap: 2px;
            text-align: left;
        }

        .stg-tit {
            font-weight: 800;
            color: var(--c-text);
            font-size: 1rem;
        }

        .stg-dsc {
            font-size: .75rem;
            color: var(--c-text-dim);
            font-weight: 600;
            text-transform: uppercase;
        }

        /* MON DETAIL - REDESIGN */
        #mon_detail .dt-cont {
            display: none;
            padding: 10px 20px 30px;
            animation: fadeIn 0.3s;
        }

        #mon_detail .dt-cont.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .mon-head {
            background: linear-gradient(135deg, #fff, #f0f9ff);
            padding: 30px 20px;
            text-align: center;
            border-bottom-left-radius: 40px;
            border-bottom-right-radius: 40px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.08);
            border-bottom: 1px solid #e5e7eb;
        }

        .big-mdl {
            font-size: 6rem;
            margin-bottom: 10px;
            animation: float 3s infinite ease-in-out;
            filter: drop-shadow(0 15px 10px rgba(0, 0, 0, 0.1));
            display: flex;
            justify-content: center;
            align-items: center;
            width: 120px;
            height: 120px;
            margin: 0 auto 10px auto;
        }

        .mon-bdg {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background: rgba(255, 255, 255, 0.9);
            padding: 6px 16px;
            border-radius: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            font-weight: 800;
            font-size: 0.9rem;
            color: #444;
            margin-top: 10px;
            border: 1px solid #e5e7eb;
        }

        .mon-bdg.max-lvl {
            color: #f59e0b;
            border-color: #f59e0b;
            background: #fffbeb;
        }

        .tab-bar {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 20px 0 10px;
            flex-shrink: 0;
            z-index: 2;
            position: relative;
        }

        .tab-btn {
            padding: 10px 25px;
            border-radius: 25px;
            background: #fff;
            color: var(--c-text-dim);
            font-weight: 800;
            cursor: pointer;
            border: 1px solid #e5e7eb;
            transition: 0.2s;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.02);
        }

        .tab-btn.active {
            background: var(--c-primary);
            color: #fff;
            border-color: var(--c-primary);
            box-shadow: 0 5px 15px rgba(59, 130, 246, 0.3);
            transform: translateY(-2px);
        }

        .stat-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 10px;
        }

        .stat-box {
            background: #fff;
            padding: 15px;
            border-radius: 16px;
            border: 1px solid #f0f0f0;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.02);
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .stat-val-group {
            display: flex;
            align-items: baseline;
            gap: 5px;
        }

        .stat-val {
            font-size: 1.3rem;
            font-weight: 800;
            color: #1f2937;
        }

        .stat-bonus {
            font-size: 0.85rem;
            color: var(--c-success);
            font-weight: 700;
        }

        .rn-lay {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            max-width: 200px;
            margin: 30px auto;
            position: relative;
        }

        .rn-lay::before {
            content: '';
            position: absolute;
            width: 100px;
            height: 100px;
            border: 2px dashed #ddd;
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 0;
        }

        .rn-sl {
            width: 70px;
            height: 70px;
            background: #fff;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            border: 2px solid #eee;
            position: relative;
            z-index: 1;
            cursor: pointer;
            transition: 0.2s;
        }

        .rn-sl:active {
            transform: scale(0.95);
        }

        .rn-sl.fil {
            border-color: var(--c-primary);
            background: #eff6ff;
        }

        .sk-lst {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 10px;
        }

        .sk-cd {
            background: #fff;
            border-radius: 16px;
            padding: 15px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.03);
            border: 1px solid #f0f0f0;
            display: flex;
            flex-direction: column;
            gap: 8px;
            text-align: left;
            position: relative;
            overflow: hidden;
        }

        .sk-cd::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            width: 5px;
            height: 100%;
            background: var(--c-gold);
        }

        .sk-nm {
            font-weight: 800;
            font-size: 1rem;
            color: #333;
        }

        .sk-inf {
            display: flex;
            justify-content: space-between;
            font-size: 0.8rem;
            color: #666;
            font-weight: 600;
        }

        .sk-desc {
            font-size: 0.8rem;
            color: #555;
            background: #fffbeb;
            padding: 8px;
            border-radius: 8px;
            border: 1px solid #fef3c7;
        }

        .parchment-modal {
            background: #fdf6e3 !important;
            border: 4px solid #d4c5a3 !important;
            border-radius: 4px !important;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3), inset 0 0 40px rgba(160, 130, 80, 0.2) !important;
            color: #5c4033;
        }

        .parchment-modal h3 {
            font-family: 'Cinzel', serif;
            color: #8b4513;
            border-bottom: 2px solid #d4c5a3;
            padding-bottom: 10px;
            margin-bottom: 15px;
        }

        .prep-actions {
            display: flex;
            flex-direction: row;
            align-items: center;
            gap: 10px;
            padding: 15px;
            background: #fff;
            border-radius: 20px 20px 0 0;
            box-shadow: 0 -5px 20px rgba(0, 0, 0, 0.05);
        }

        .prep-actions > .btn,
        .prep-actions > #btn-farm {
            flex: 1;
            display: flex;
        }

        .prep-actions .btn {
            height: 50px;
            font-size: .9rem;
            padding: 0 10px;
            width: 100%;
        }

        #btn-farm {
            display: none; /* Hidden by default */
        }

        /* DEX */
        #dex-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(60px, 2fr));
            gap: 15px;
            margin-top: 20px;
            padding: 15px;
            align-content: flex-start;
            justify-content: center;
        }

        .dx-sl {
            width: 100%;
            aspect-ratio: 1;
            position: relative;
            background: #fff;
            border-radius: 14px;
            border: 2px solid #e5e7eb;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center; /* Centraliza os itens verticalmente */
            gap: 4px; /* Adiciona um pequeno espaço entre os itens */
            padding: 4px;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }

        .dx-sl.unk {
            filter: grayscale(1);
            opacity: 0.6;
        }

        .dx-sl.unk::after {
            content: '?';
            position: absolute;
            inset: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            color: rgba(0, 0, 0, 0.2);
            font-weight: 900;
            z-index: 2;
        }

        .dx-name-mini {
            font-size: 0.6rem;
            font-weight: bold;
            color: #555;
            text-align: center;
            line-height: 1.1;
            width: 100%;
            padding: 0 2px;
        }

        .dx-sl .stars {
            position: static; /* Remove o posicionamento absoluto */
            width: auto; /* Deixa a largura ser automática */
            margin-top: 0; /* Reseta a margem */
        }

        .dx-dt-head {
            display: flex;
            gap: 20px;
            align-items: center;
            padding: 15px;
            background: rgba(249, 250, 251, 0.8);
            border-radius: 16px;
            border: 1px solid #eee;
            margin-bottom: 15px;
        }

        /* ARENA SPECIFIC */
        .arena-bg {
            background: linear-gradient(135deg, #4b1e1b, #7f1d1d);
            border: 2px solid #fca5a5;
            color: #fff;
        }

        .arena-rank-icon {
            font-size: 2rem;
        }

        .opp-card {
            background: #fff;
            border-radius: 12px;
            padding: 12px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border: 1px solid #eee;
        }

        .opp-info {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .opp-avatar {
            width: 40px;
            height: 40px;
            background: #eee;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .opp-details {
            display: flex;
            flex-direction: column;
            text-align: left;
        }

        .opp-name {
            font-weight: 800;
            font-size: 0.9rem;
            color: #333;
        }

        .opp-rank {
            font-size: 0.75rem;
            color: #666;
        }

        /* ARENA TEAM PREVIEW FIX */
        .arena-team-row {
            display: flex;
            gap: 5px;
            justify-content: flex-end;
            margin-bottom: 5px;
        }

        .arena-team-icon {
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            border-radius: 5px;
            background: rgba(0, 0, 0, 0.05);
            overflow: hidden;
        }

        .arena-team-icon img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        @keyframes flg {
            0% {
                opacity: 0;
                background: #fff
            }
            10% {
                opacity: 1;
                background: #fff
            }
            30% {
                background: #fbbf24
            }
            100% {
                opacity: 0
            }
        }

        /* EFEITOS DE BATALHA (FX) */
        .fx { position: absolute; top: 20%; left: 0; width: 100%; text-align: center; font-size: 4rem; z-index: 200; pointer-events: none; text-shadow: 0 0 10px rgba(0,0,0,0.5); }
        
        .fx-slash { animation: fxSlash .4s ease-out forwards; }
        .fx-rise { animation: fxRise .6s ease-out forwards; }
        .fx-splash { animation: fxSplash .5s ease-out forwards; }
        .fx-spin { animation: fxSpin .5s linear forwards; }
        .fx-drop { animation: fxDrop .4s cubic-bezier(0.18, 0.89, 0.32, 1.28) forwards; }
        .fx-pulse { animation: fxPulse .5s ease-in-out forwards; }
        .fx-shake { animation: fxShake .4s ease-in-out forwards; }

        @keyframes fxSlash { 0% { opacity:0; transform: scale(0.5) rotate(-45deg); } 50% { opacity:1; transform: scale(1.5) rotate(0deg); } 100% { opacity:0; transform: scale(1) rotate(45deg); } }
        @keyframes fxRise { 0% { opacity:0; transform: translateY(20px) scale(0.5); } 50% { opacity:1; transform: translateY(-20px) scale(1.2); } 100% { opacity:0; transform: translateY(-50px) scale(1); } }
        @keyframes fxSplash { 0% { opacity:0; transform: scale(0); } 50% { opacity:1; transform: scale(1.5); } 100% { opacity:0; transform: scale(2); } }
        @keyframes fxSpin { 0% { opacity:0; transform: rotate(0deg) scale(0); } 50% { opacity:1; transform: rotate(180deg) scale(1.5); } 100% { opacity:0; transform: rotate(360deg) scale(0); } }
        @keyframes fxDrop { 0% { opacity:0; transform: translateY(-50px) scale(1.5); } 60% { opacity:1; transform: translateY(0) scale(1); } 100% { opacity:0; transform: scale(0.8); } }
        @keyframes fxPulse { 0% { opacity:0; transform: scale(0.5); } 50% { opacity:1; transform: scale(1.5); filter: brightness(2); } 100% { opacity:0; transform: scale(2); } }
        @keyframes fxShake { 0% { opacity:0; transform: translateX(0); } 25% { opacity:1; transform: translateX(-10px); } 75% { transform: translateX(10px); } 100% { opacity:0; transform: translateX(0); } }

        @keyframes activeZoom {
            0%, 100% { transform: scale(1.3); }
            50% { transform: scale(1.4); }
        }